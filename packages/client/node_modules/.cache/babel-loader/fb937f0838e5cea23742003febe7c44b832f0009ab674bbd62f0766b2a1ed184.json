{"ast":null,"code":"import _toConsumableArray from\"C:/Users/elaia/YandexDisk/Frontend/\\u041F\\u043E\\u0440\\u0442\\u0444\\u043E\\u043B\\u0438\\u043E/react-todo-list/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _createForOfIteratorHelper from\"C:/Users/elaia/YandexDisk/Frontend/\\u041F\\u043E\\u0440\\u0442\\u0444\\u043E\\u043B\\u0438\\u043E/react-todo-list/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _regeneratorRuntime from\"C:/Users/elaia/YandexDisk/Frontend/\\u041F\\u043E\\u0440\\u0442\\u0444\\u043E\\u043B\\u0438\\u043E/react-todo-list/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/elaia/YandexDisk/Frontend/\\u041F\\u043E\\u0440\\u0442\\u0444\\u043E\\u043B\\u0438\\u043E/react-todo-list/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/elaia/YandexDisk/Frontend/\\u041F\\u043E\\u0440\\u0442\\u0444\\u043E\\u043B\\u0438\\u043E/react-todo-list/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import Container from'../../components/UI/Container/Container';import Headline1 from'../../components/UI/Headline1/Headline1';import ToDoList from'../../components/ToDoList/ToDoList';import RoundButton from'../../components/UI/RoundButton/RoundButton';import style from'./Tasks.module.less';import{ReactComponent as Plus}from'../../assets/svg/plus.svg';import Modal from'../../components/UI/Modal/Modal';import AddEditForm from'../../components/AddEditForm/AddEditForm';import axios from'axios';import Loader from'../../components/UI/Loader/Loader';import dayjs from'dayjs';import utc from'dayjs/plugin/utc';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";dayjs.extend(utc);export default function Tasks(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tasks=_useState2[0],setTasks=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isEdit=_useState4[0],setIsEdit=_useState4[1];var _useState5=useState({id:0,completed:false,expire:'',name:'',description:'',files:[]}),_useState6=_slicedToArray(_useState5,2),taskForEdit=_useState6[0],setTaskForEdit=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),modal=_useState8[0],setModal=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isLoading=_useState10[0],setIsLoading=_useState10[1];var fetchTasks=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.next=3;return axios.get('/read');case 3:response=_context.sent;setTasks(response.data);setIsLoading(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchTasks(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchTasks();},[]);var setCompleted=function setCompleted(completed,completedTask){setTasks(tasks.map(function(task){if(task.id===completedTask.id){task.completed=completed;return task;}return task;}));var formData=new FormData();formData.append('id',completedTask.id);formData.append('completed',completedTask.completed);formData.append('expire',completedTask.expire);formData.append('name',completedTask.name);formData.append('description',completedTask.description);if(completedTask.files.length){var _iterator=_createForOfIteratorHelper(completedTask.files),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var file=_step.value;formData.append('files',file);}}catch(err){_iterator.e(err);}finally{_iterator.f();}}else{formData.append('files',[]);}axios.post('/update',formData,{headers:{'X-HTTP-Method-Override':'PUT'}});};var openEditForm=function openEditForm(task){setIsEdit(true);setTaskForEdit(task);setModal(true);};var openAddForm=function openAddForm(){setIsEdit(false);setTaskForEdit({id:0,completed:false,expire:dayjs.utc().format('YYYY-MM-DDTHH:mm'),name:'',description:'',files:[]});setModal(true);};var addTask=function addTask(newTask){setTasks([].concat(_toConsumableArray(tasks),[newTask]));setModal(false);};var editTask=function editTask(editedTask){setTasks(tasks.map(function(task){if(task.id===editedTask.id){return editedTask;}return task;}));setModal(false);};var removeTask=function removeTask(taskId){setTasks(tasks.filter(function(task){return task.id!==taskId;}));axios.delete(\"/delete/\".concat(taskId));};return/*#__PURE__*/_jsxs(Container,{className:style.Tasks,children:[modal&&/*#__PURE__*/_jsx(Modal,{className:style.Tasks__modal,setVisible:setModal,children:/*#__PURE__*/_jsx(AddEditForm,{className:style.Tasks__form,addTask:addTask,editTask:editTask,taskForEdit:taskForEdit,isEdit:isEdit})}),/*#__PURE__*/_jsx(Headline1,{className:style.Tasks__headline,children:\"ToDo List\"}),isLoading?/*#__PURE__*/_jsx(Loader,{className:style.Tasks__loader}):/*#__PURE__*/_jsx(ToDoList,{className:style.Tasks__list,tasks:tasks,openEditForm:openEditForm,removeTask:removeTask,setCompleted:setCompleted}),/*#__PURE__*/_jsx(RoundButton,{className:style.Tasks__add,onClick:openAddForm,children:/*#__PURE__*/_jsx(Plus,{})})]});}","map":{"version":3,"names":["React","useState","useEffect","Container","Headline1","ToDoList","RoundButton","style","ReactComponent","Plus","Modal","AddEditForm","axios","Loader","dayjs","utc","extend","Tasks","tasks","setTasks","isEdit","setIsEdit","id","completed","expire","name","description","files","taskForEdit","setTaskForEdit","modal","setModal","isLoading","setIsLoading","fetchTasks","get","response","data","setCompleted","completedTask","map","task","formData","FormData","append","length","file","post","headers","openEditForm","openAddForm","format","addTask","newTask","editTask","editedTask","removeTask","taskId","filter","delete","Tasks__modal","Tasks__form","Tasks__headline","Tasks__loader","Tasks__list","Tasks__add"],"sources":["C:/Users/elaia/YandexDisk/Frontend/Портфолио/react-todo-list/packages/client/src/pages/Tasks/Tasks.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Container from '../../components/UI/Container/Container';\r\nimport Headline1 from '../../components/UI/Headline1/Headline1';\r\nimport ToDoList from '../../components/ToDoList/ToDoList';\r\nimport RoundButton from '../../components/UI/RoundButton/RoundButton';\r\nimport style from './Tasks.module.less';\r\nimport { ReactComponent as Plus } from '../../assets/svg/plus.svg';\r\nimport Modal from '../../components/UI/Modal/Modal';\r\nimport AddEditForm from '../../components/AddEditForm/AddEditForm';\r\nimport axios from 'axios';\r\nimport Loader from '../../components/UI/Loader/Loader';\r\nimport dayjs from 'dayjs';\r\nimport utc from 'dayjs/plugin/utc';\r\ndayjs.extend(utc);\r\n\r\nexport default function Tasks() {\r\n  const [tasks, setTasks] = useState([]);\r\n  const [isEdit, setIsEdit] = useState(false);\r\n  const [taskForEdit, setTaskForEdit] = useState({\r\n    id: 0,\r\n    completed: false,\r\n    expire: '',\r\n    name: '',\r\n    description: '',\r\n    files: [],\r\n  });\r\n  const [modal, setModal] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const fetchTasks = async () => {\r\n    setIsLoading(true);\r\n    const response = await axios.get('/read');\r\n    setTasks(response.data);\r\n    setIsLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchTasks();\r\n  }, []);\r\n\r\n  const setCompleted = (completed, completedTask) => {\r\n    setTasks(\r\n      tasks.map(task => {\r\n        if (task.id === completedTask.id) {\r\n          task.completed = completed;\r\n          return task;\r\n        }\r\n\r\n        return task;\r\n      })\r\n    );\r\n\r\n    let formData = new FormData();\r\n\r\n    formData.append('id', completedTask.id);\r\n    formData.append('completed', completedTask.completed);\r\n    formData.append('expire', completedTask.expire);\r\n    formData.append('name', completedTask.name);\r\n    formData.append('description', completedTask.description);\r\n    if (completedTask.files.length) {\r\n      for (const file of completedTask.files) {\r\n        formData.append('files', file);\r\n      }\r\n    } else {\r\n      formData.append('files', []);\r\n    }\r\n\r\n    axios.post('/update', formData, {\r\n      headers: {\r\n        'X-HTTP-Method-Override': 'PUT',\r\n      },\r\n    });\r\n  };\r\n\r\n  const openEditForm = task => {\r\n    setIsEdit(true);\r\n    setTaskForEdit(task);\r\n    setModal(true);\r\n  };\r\n\r\n  const openAddForm = () => {\r\n    setIsEdit(false);\r\n    setTaskForEdit({\r\n      id: 0,\r\n      completed: false,\r\n      expire: dayjs.utc().format('YYYY-MM-DDTHH:mm'),\r\n      name: '',\r\n      description: '',\r\n      files: [],\r\n    });\r\n    setModal(true);\r\n  };\r\n\r\n  const addTask = newTask => {\r\n    setTasks([...tasks, newTask]);\r\n    setModal(false);\r\n  };\r\n\r\n  const editTask = editedTask => {\r\n    setTasks(\r\n      tasks.map(task => {\r\n        if (task.id === editedTask.id) {\r\n          return editedTask;\r\n        }\r\n\r\n        return task;\r\n      })\r\n    );\r\n\r\n    setModal(false);\r\n  };\r\n\r\n  const removeTask = taskId => {\r\n    setTasks(tasks.filter(task => task.id !== taskId));\r\n    axios.delete(`/delete/${taskId}`);\r\n  };\r\n\r\n  return (\r\n    <Container className={style.Tasks}>\r\n      {modal && (\r\n        <Modal\r\n          className={style.Tasks__modal}\r\n          setVisible={setModal}\r\n        >\r\n          <AddEditForm\r\n            className={style.Tasks__form}\r\n            addTask={addTask}\r\n            editTask={editTask}\r\n            taskForEdit={taskForEdit}\r\n            isEdit={isEdit}\r\n          />\r\n        </Modal>\r\n      )}\r\n      <Headline1 className={style.Tasks__headline}>ToDo List</Headline1>\r\n      {isLoading ? (\r\n        <Loader className={style.Tasks__loader} />\r\n      ) : (\r\n        <ToDoList\r\n          className={style.Tasks__list}\r\n          tasks={tasks}\r\n          openEditForm={openEditForm}\r\n          removeTask={removeTask}\r\n          setCompleted={setCompleted}\r\n        ></ToDoList>\r\n      )}\r\n      <RoundButton\r\n        className={style.Tasks__add}\r\n        onClick={openAddForm}\r\n      >\r\n        <Plus />\r\n      </RoundButton>\r\n    </Container>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}